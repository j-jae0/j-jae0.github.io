---
title: "[Python] DataFrame을 요약하는 함수 정의하기"
excerpt: "dataframe을 이해하기 위해 사용하는 shape, head, describe 등의 기능을 한 번에 출력할 수 있는 함수를 정의한다."
layout: single
categories: "Python"

toc: true
toc_sticky: true
toc_label : "목차"
toc_icon: "bars"
---

***

데이터프레임을 정의하고 데이터를 이해하기 위해선 다음과 같은 작업을 수행한다. 하지만 아래 기존 방식 코드를 보면 알 수 있듯이 한 눈에 파악하기 어렵다는 단점이 있다. 이러한 단점을 해결하고자 데이터 이해를 위한 정보를 함축한 데이터프레임을 생성하는 함수를 미리 정의하였다.

## 1. 기존 방식
```python
# 데이터 크기 출력
print(df.shape)

# 데이터 정보
print(train.info())

# 데이터 파악
display(df.head())
display(df.tail())

# 데이터 개수 파악(전체 개수, 유일값, 결측값)
display(df.describe(include='all'))
```

위와 같은 작업을 통해 데이터를 이해하는데 위 코드를 실행하면 스크롤을 통해 각 정보를 확인해야된다는 점에서 한 눈에 전체 데이터를 이해하기엔 어렵다. 그래서 중요한 정보를 하나의 데이터프레임으로 요약하여 전체 데이터를 한 눈에 파악하기 좋게 summary용 df를 생성하는 함수를 정의해 보았다.

## 2. 함수 정의
```python
def summary(df):
    print(f'data shape: {df.shape}')
    describes = df.describe(include='all', datetime_is_numeric=True).T
    # summary용 dataframe 생성
    summary_df = pd.DataFrame(df.dtypes, columns=['data type'])
    summary_df['#unique'] = df.nunique().values
    summary_df['#missing'] = df.isnull().sum().values
    summary_df['%missing'] = df.isnull().mean().values * 100
    if 'min' in describes.columns:
        summary_df['min'] = describes['min'].values
        summary_df['max'] = describes['max'].values
    if 'top' in describes.columns:
        summary_df['top'] = describes['top'].values
        summary_df['freq'] = describes['freq'].values
    summary_df['1st value'] = df.loc[0].values
    summary_df['2nd value'] = df.loc[1].values
    summary_df['3rd value'] = df.loc[2].values
    return summary_df
```

summary 용 데이터프레임을 생성하기 위한 함수를 보면 if 문을 두 번 사용했는데 이는 주어진 데이터가 모두 숫자로 이루어진 경우 또는 문자열로 이루어진 경우를 고려하기 위해서이다. 또한 문자, 숫자 두 형태 모두를 포함하는 데이터는 min, max, top, freq 컬럼이 모두 출력된다.

## 3. 비교
함수를 정의했을 때와 함수를 사용하기 전의 실행 결과를 비교해 보면 아래 이미지와 같다. 예시를 위해 사용한 데이터는 [Kaggle datasets, 'Forecasting Mini-Course Sales'](https://www.kaggle.com/competitions/playground-series-s3e19)에서 다운받은 것을 사용하였고 코드 실행은 Jupyter notebook에서 진행하였다. 

<div style="text-align : center;">
<img src="/assets/images/python/python_14_1.png" width="80%">
</div>
<center><small>Fig 1. 기존 방식 결과</small></center>

<br>

Fig 1엔 상위 3개의 데이터, 하위 3개의 데이터(```df.head(3), df.tail(3)```)를 포함한다.

<div style="text-align : center;">
<img src="/assets/images/python/python_14_2.png" width="90%">
</div>
<center><small>Fig 2. 함수 사용 결과</small></center>

<br>


## 💡 datetime_is_numeric=True 
만약 날짜형 데이터가 있는 데이터프레임을 기술통계를 확인하기 위해 describe 함수를 사용하면 아래와 같은 메시지가 발생한다. 아래 warning 메시지는 describe 함수에 ```datetime_is_numeric=True``` 인자를 전달하지 않은 것이다(pandas에선 이후 버전에 datetime을 카테고리 값으로 여기지 않고 숫자로 취급하여 기술 통계낼 것이라고 밝힘).<br>
<small>cf. 사용하고 있는 판다스 버전: '1.4.2'</small>

> FutureWarning: Treating datetime data as categorical rather than numeric in `.describe` is deprecated and will be removed in a future version of pandas. Specify `datetime_is_numeric=True` to silence this warning and adopt the future behavior now.
  df.describe(include='all')

위 메시지를 출력하고 싶지 않다면, warnings 를 사용하여 오류메시지를 무시하는 방법도 있지만 describe 함수를 사용하여 기술통계값을 낼 때, ```datetime_is_numeric=True``` 를 사용하도록 하여 오류 메시지가 발생되지 않도록 하는 것이 좋다.<br>
예시로 사용한 [Kaggle datasets, 'Forecasting Mini-Course Sales'](https://www.kaggle.com/competitions/playground-series-s3e19) 의 컬럼 중 'date' 를 pandas to_datetime 함수를 사용하여 날짜형 데이터로 변환하고 함수를 적용해 보면 아래와 같은 결과가 나온다.

<div style="text-align : center;">
<img src="/assets/images/python/python_14_3.png" width="90%">
</div>
<center><small>Fig 3. 날짜 데이터를 포함하는 경우, 함수 사용 결과</small></center>

<br>

👩🏻‍💻개인 공부 기록용 블로그입니다
<br>오류나 틀린 부분이 있을 경우 댓글 혹은 메일로 따끔하게 지적해주시면 감사하겠습니다.
{: .notice}