---
title:  "[ML] ì‚¬ì´í‚·ëŸ°(scikit-learn)ìœ¼ë¡œ ë³´ìŠ¤í„´ ì§‘ê°’ ì˜ˆì¸¡í•˜ê¸° - ë‹¤ì¤‘ì„ í˜•íšŒê·€(Multiple Linear Regression)"
layout: single

categories: "ML"
tags: ["ë‹¤ì¤‘ì„ í˜•íšŒê·€", "ì‚¬ì´í‚·ëŸ°"]

toc: true
toc_sticky: true
toc_label : "ëª©ì°¨"
toc_icon: "bars"
---

<small>ì‚¬ì´í‚·ëŸ°ì˜ ë³´ìŠ¤í„´ ì£¼íƒ ê°€ê²© ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì¤‘ì„ í˜•íšŒê·€ ë¶„ì„ì„ í•œë‹¤. ì°¸ê³ ë¡œ í•´ë‹¹ ë°ì´í„°ì…‹ì€ ìœ¤ë¦¬ì ì¸ ë¬¸ì œë¡œ scikit-learn 1.2 ë²„ì „ ì´í›„ë¡œ ì‚­ì œë˜ì—ˆë‹¤.</small>

***

# 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ë°ì´í„° ë¡œë“œ
```python
# í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬
from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
import pandas as pd  

# ë³´ìŠ¤í„´ ë°ì´í„°ì…‹ì„ boston_dataset ë³€ìˆ˜ì— ì €ì¥
boston_dataset = load_boston()

# ì…ë ¥ë³€ìˆ˜ì™€ ì¶œë ¥ë³€ìˆ˜ ëª¨ë‘ dataframe í˜•íƒœë¡œ ì €ì¥
x = pd.DataFrame(diabetes_dataset.data, columns=diabetes_dataset.feature_names)
y = pd.DataFrame(diabetes_dataset.target, columns=['diabetes'])
```

<div style="text-align : center;">
<img src="/assets/images/boston_data_target.png" width="700">
</div>
<center><small>ì…ë ¥ ë³€ìˆ˜(ì™¼ìª½), ì¶œë ¥ ë³€ìˆ˜(ì˜¤ë¥¸ìª½)</small></center>

<br>

# 2. í•™ìŠµ, í…ŒìŠ¤íŠ¸ ë°ì´í„° ë‚˜ëˆ„ê¸°
```python
from sklearn.model_selection import train_test_split

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=42)
```

í•™ìŠµ ë°ì´í„°ì…‹ì€ 80%, í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì€ 20%ë¡œ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê³  ```random_state```ë¥¼ 42ë¡œ ì„¤ì •í•˜ì—¬ ë°ì´í„° ë¶„ë°° ê²°ê³¼ë¥¼ ê³ ì •í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

```python
# ì˜ ë‚˜ëˆ„ì–´ì¡ŒëŠ”ì§€ shapeë¡œ í™•ì¸
print(x_train.shape, x_test.shape, y_train.shape, y_test.shape)
```
```
ì¶œë ¥ ê²°ê³¼
((404, 13), (102, 13), (404, 1), (102, 1))
```

<br>

# 3. ëª¨ë¸ë§, í‰ê°€
```python
# ì„ í˜• íšŒê·€
model = LinearRegression()
# í•™ìŠµë°ì´í„°ë¡œ ëª¨ë¸ í•™ìŠµ
model.fit(x_train, y_train)
# í•™ìŠµì´ ì™„ë£Œëœ ëª¨ë¸ì— í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì—¬ yê°’ì„ ì˜ˆì¸¡
y_predict = model.predict(x_test)

# í‰ê°€ (RMSE)ë¥¼ ìœ„í•´ MSE ë¡œë“œ
from sklearn.metrics import mean_squared_error
mean_squared_error(y_test, y_test_prediction) ** 0.5
```
```
ì¶œë ¥ ê²°ê³¼
4.928602182665323
```

ë³´ìŠ¤í„´ ì£¼íƒ ê°€ê²© ë°ì´í„°ì…‹ì„ í•™ìŠµ, í…ŒìŠ¤íŠ¸ 8:2ë¡œ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê³  ì„ í˜• íšŒê·€ë¡œ ë¶„ì„í•œ ê²°ê³¼ ì•½ 4.9 ì •ë„ì˜ ì˜¤ì°¨ë¥¼ ê°€ì§€ëŠ” ëª¨ë¸ì„ ìƒì„±í•˜ì˜€ë‹¤. ì´ì „ì— ë²”ì£„ìœ¨ë§Œ ê°€ì§€ê³  ì£¼íƒ ê°€ê²©ì„ ì˜ˆì¸¡í–ˆì„ ë•Œë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ì•„ì¡ŒìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.(ì´ì „ RMSE : ì•½ 7.8)

<br>

# 4. ìµœì ì„ 

```python
# theta 0ì˜ ê°’
model.intercept_
# theta 1, 2, 3 ... ì˜ ê°’
model.coef_
```
**theta 0ì˜ ê°’** : <br>
```array([30.24675099])``` <br>
**theta 1, 2, 3, ..., 13ì˜ ê°’** : 
```
array([[-1.13055924e-01,  3.01104641e-02,  4.03807204e-02,
         2.78443820e+00, -1.72026334e+01,  4.43883520e+00,
        -6.29636221e-03, -1.44786537e+00,  2.62429736e-01,
        -1.06467863e-02, -9.15456240e-01,  1.23513347e-02,
        -5.08571424e-01]])
```

ì´ë²ˆ ê²°ê³¼ëŠ” ì´ì „ì— ë¶„ì„í•œ ê²°ê³¼(ì…ë ¥ê°’ì´ 1ê°œ)ì™€ëŠ” ë‹¤ë¥´ê²Œ ì…ë ¥ë³€ìˆ˜ê°€ 13ê°œì´ê¸° ë•Œë¬¸ì— ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•˜ê¸° ì–´ë µë‹¤. í•˜ì§€ë§Œ ë‹¤ì¤‘ì„ í˜•íšŒê·€ ëª¨ë¸ë¡œ ìµœì ì„ ì˜ ì„¸íƒ€ê°’ë“¤ì€ êµ¬í•  ìˆ˜ ìˆë‹¤.

<br>

# 6. Reference
- [scikit-learn ê³µì‹ ë¬¸ì„œ, ë³´ìŠ¤í„´ ë°ì´í„°ì…‹](https://scikit-learn.org/0.15/modules/generated/sklearn.datasets.load_boston.html)

<br>

ğŸ‘©ğŸ»â€ğŸ’»ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤
<br>ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ë”°ë”í•˜ê²Œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.
{: .notice}