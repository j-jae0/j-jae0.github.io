---
title:  "[ML] ì‚¬ì´í‚·ëŸ°(scikit-learn)ìœ¼ë¡œ ë³´ìŠ¤í„´ ì§‘ê°’ ì˜ˆì¸¡í•˜ê¸° - ì„ í˜•íšŒê·€(Linear Regression)"
layout: single

categories: "ML"
tags: ["ì„ í˜•íšŒê·€", "ì‚¬ì´í‚·ëŸ°"]

toc: true
toc_sticky: true
toc_label : "ëª©ì°¨"
toc_icon: "bars"
---

<small>ì‚¬ì´í‚·ëŸ°ì˜ ë³´ìŠ¤í„´ ì£¼íƒ ê°€ê²© ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ ì„ í˜•íšŒê·€ ë¶„ì„ì„ í•œë‹¤.</small>

***

# 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ë°ì´í„° ë¡œë“œ
```python
# ë°ì´í„°í”„ë ˆì„ í˜•íƒœë¡œ ë§Œë“¤ê¸°ìœ„í•´ pandas ë¡œë“œ
import pandas as pd
# sklean ë‚´ì¥ ë°ì´í„°ì…‹ì¸ ë³´ìŠ¤í„´ ì£¼íƒê°€ê²© ë°ì´í„°ì…‹ ë¡œë“œ
from sklearn.datasets import load_boston
# ë³´ìŠ¤í„´ ë°ì´í„°ì…‹ì„ boston_dataset ë³€ìˆ˜ì— ì €ì¥
boston_dataset = load_boston()
```

<br>

# 2. ë°ì´í„° ì •ë³´ í™•ì¸
```python
print(boston_dataset.DESCR)
```
ğŸ“ **ìœ„ ì½”ë“œì— ëŒ€í•œ ì¶œë ¥ ê²°ê³¼(ì¼ë¶€ë§Œ ê°€ì ¸ì˜´)**

<div style="text-align : center;">
<img src="/assets/images/boston_DESCR.png" width="700">
</div>
<center><small>ë°ì´í„°ì…‹ì˜ ì„¤ëª… ë° í”¼ì²˜ ì„¤ëª…</small></center>

<br>

ë³´ìŠ¤í„´ ë°ì´í„°ì…‹ì—ì„œ ì…ë ¥ë³€ìˆ˜ëŠ” 13ê°œ, ì¶œë ¥ë³€ìˆ˜ëŠ” 1ê°œ(```MEDV```)ì´ë©° í”¼ì²˜ì— ëŒ€í•œ ì„¤ëª…ì€ ìœ„ì™€ ê°™ë‹¤. ì´ë²ˆ ì„ í˜• íšŒê·€ ëª¨ë¸ì—ëŠ” ì…ë ¥ë³€ìˆ˜ë¥¼ ë²”ì£„(```CRIM```)ë§Œ ì‚¬ìš©í•˜ì—¬ ë²”ì£„ìœ¨ì— ë”°ë¥¸ ì§‘ ê°’ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.

<br>

# 3. ì…ë ¥ë³€ìˆ˜, ì¶œë ¥ë³€ìˆ˜ ì§€ì •
```python
# ì…ë ¥ë³€ìˆ˜ì™€ ì¶œë ¥ë³€ìˆ˜ ëª¨ë‘ dataframe í˜•íƒœë¡œ ì €ì¥
x = pd.DataFrame(boston_dataset.data, columns=boston.feature_names)[['CRIM']]
y = pd.DataFrame(boston_dataset.target, columns=['MEDV'])
```

<div style="text-align : center;">
<img src="/assets/images/boston_x_y.png" width="200">
</div>
<center><small>ì…ë ¥ ë³€ìˆ˜(ì™¼ìª½), ì¶œë ¥ ë³€ìˆ˜(ì˜¤ë¥¸ìª½)</small></center>

<br>

# 4. í•™ìŠµ, í…ŒìŠ¤íŠ¸ ë°ì´í„° ë‚˜ëˆ„ê¸°
```python
from sklearn.model_selection import train_test_split

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=.2, random_state=42)
```

í•™ìŠµ ë°ì´í„°ì…‹ì€ 80%, í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì€ 20%ë¡œ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê³  ```random_state```ë¥¼ 42ë¡œ ì„¤ì •í•˜ì—¬ ë°ì´í„° ë¶„ë°° ê²°ê³¼ë¥¼ ê³ ì •í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

```python
# ì˜ ë‚˜ëˆ„ì–´ì¡ŒëŠ”ì§€ shapeë¡œ í™•ì¸
print(x_train.shape, x_test.shape, y_train.shape, y_test.shape)
```
```
ì¶œë ¥ ê²°ê³¼
(404, 1) (102, 1) (404, 1) (102, 1)
```

<br>

# 5. ëª¨ë¸ë§, í‰ê°€
```python
# ì„ í˜• íšŒê·€
from sklearn.linear_model import LinearRegression

model = LinearRegression()
# í•™ìŠµë°ì´í„°ë¡œ ëª¨ë¸ í•™ìŠµ
model.fit(x_train, y_train)
# í•™ìŠµì´ ì™„ë£Œëœ ëª¨ë¸ì— í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì—¬ yê°’ì„ ì˜ˆì¸¡
y_predict = model.predict(x_test)

# í‰ê°€ (RMSE)ë¥¼ ìœ„í•´ MSE ë¡œë“œ
from sklearn.metrics import mean_squared_error
mean_squared_error(y_test, y_test_prediction) ** 0.5
```
```
ì¶œë ¥ ê²°ê³¼
7.854561569919787
```

ë³´ìŠ¤í„´ ì£¼íƒ ê°€ê²© ë°ì´í„°ì…‹ì„ í•™ìŠµ, í…ŒìŠ¤íŠ¸ 8:2ë¡œ ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê³  ì„ í˜• íšŒê·€ë¡œ ë¶„ì„í•œ ê²°ê³¼ ì•½ 7.8 ì •ë„ì˜ ì˜¤ì°¨ë¥¼ ê°€ì§€ëŠ” ëª¨ë¸ì„ ìƒì„±í•˜ì˜€ë‹¤.

<br>

# 6. Reference
- [scikit-learn ê³µì‹ ë¬¸ì„œ, ë³´ìŠ¤í„´ ë°ì´í„°ì…‹](https://scikit-learn.org/0.15/modules/generated/sklearn.datasets.load_boston.html)

<br>

ğŸ‘©ğŸ»â€ğŸ’»ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤
<br>ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ë”°ë”í•˜ê²Œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.
{: .notice}