---
title: "[Forecasting] 2022ë…„ íŒë§¤ëŸ‰ ì˜ˆì¸¡í•˜ê¸° - EDA"
excerpt: "ìºê¸€ ë°ì´í„°ì…‹, Forecasting Mini-Course(S3E19) EDA ì§„í–‰"
layout: single
categories: "Python"
tags: ["EDA"]

toc: true
toc_sticky: true
toc_label : "ëª©ì°¨"
toc_icon: "bars"
published: false
---

ğŸŒˆ **Kaggle Playground**
<br>ë°ì´í„°ëŠ” [Kaggle datasets, 'Forecasting Mini-Course Sales'](https://www.kaggle.com/competitions/playground-series-s3e19)ì—ì„œ ë‹¤ìš´ ë°›ì•„ì„œ ì‚¬ìš©í•˜ì˜€ë‹¤. 
ë°ì´í„°ëŠ” ë‚ ì§œ, êµ­ê°€, ë§¤ì¥, ì œí’ˆ, íŒë§¤ëŸ‰ì„ í¬í•¨í–”ë‹¤. ë³¸ í”„ë¡œì íŠ¸ì˜ ëª©í‘œëŠ” ì£¼ì–´ì§„ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ 2022ë…„ì˜ íŒë§¤ëŸ‰ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë‹¤.
{: .notice}


# 1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ
```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

import koreanize_matplotlib
%config InlineBackend.figure_format = 'retina'
```

# 2. ë°ì´í„° ë¡œë“œ
```python
df = pd.read_csv('/kaggle/input/playground-series-s3e19/train.csv')
```

# 3. EDA
## (1) ê¸°ìˆ í†µê³„
```python
# ë°ì´í„° ìš”ì•½ìš© í•¨ìˆ˜
def summary(df):
    print(f'data shape: {df.shape}')
    describes = df.describe(include='all', datetime_is_numeric=True).T
    # summaryìš© dataframe ìƒì„±
    summary_df = pd.DataFrame(df.dtypes, columns=['data type'])
    summary_df['#unique'] = df.nunique().values
    summary_df['#missing'] = df.isnull().sum().values
    summary_df['%missing'] = df.isnull().mean().values * 100
    if 'min' in describes.columns:
        summary_df['min'] = describes['min'].values
        summary_df['max'] = describes['max'].values
        summary_df['mean'] = describes['mean'].values
        summary_df['std'] = describes['std'].values
    if 'top' in describes.columns:
        summary_df['top'] = describes['top'].values
        summary_df['freq'] = describes['freq'].values
    summary_df['1st value'] = df.loc[0].values
    summary_df['2nd value'] = df.loc[1].values
    summary_df['3rd value'] = df.loc[2].values
    return summary_df

summary(df)
```

<div style="text-align : center;">
<img src="/assets/images/project/s3e19/s3e19_1.png">
</div>

<br>

### 1-1. ìˆ˜ì¹˜í˜• ë°ì´í„°
- id ì€ ìœ ì¼ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì¡Œë‹¤(0 ~ 136949 ì‚¬ì´ì˜ ê°’ì„ ê°€ì§).
- num_sold ë¥¼ ë³´ë©´ ë‚ ì§œ, ë‚˜ë¼, ë§¤ì¥, ìƒí’ˆë³„ íŒë§¤ëŸ‰ì„ ë‚˜íƒ€ë‚´ëŠ”ë° ìµœì†Ÿê°’ 2, ìµœëŒ“ê°’ 1380, í‰ê·  165.522636(â‰ˆ 166), í‘œì¤€í¸ì°¨ 183.691575(â‰ˆ 184)ì˜ ê¸°ìˆ í†µê³„ëŸ‰ì„ ê°€ì§„ë‹¤.

### 1-2. ë²”ì£¼í˜• ë°ì´í„°
- date ëŠ” 'ì—°ë„-ì›”-ì¼' ë¡œ ë‚ ì§œë¥¼ í‘œí˜„í•˜ë©° '2017-01-01'ì´ ì‹œì‘ê°’ì´ë‹¤.
  - object íƒ€ì…ì„ datetimeìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì´ í•„ìš”
  - ë‚ ì§œë³„ íŒë§¤ì¶”ì´ë¥¼ í™•ì¸í•´ë³¼ í•„ìš”ê°€ ìˆìŒ
- country, store, product ëŠ” categorical ë°ì´í„°ì´ë‹¤.
  - topì„ ë³´ë©´ ë‚˜ë¼ 'Argentina', ë§¤ì¥ 'Kaggle Learn', ìƒí’ˆ 'Using LLMs to Improve Your Coding'ì´ ê°€ì¥ ë§ì´ ë“±ì¥í–ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
    - ë§Œì•½ ë“±ì¥í•œ íšŸìˆ˜ê°€ ëª¨ë‘ ë™ì¼í•˜ë©´ ì²« ë²ˆì§¸ ìš”ì†Œê°€ ëŒ€í‘œë¡œ ì¶œë ¥ëœë‹¤(í™•ì¸í•´ë³¼ í•„ìš”ê°€ ìˆìŒ).


## (2) datetime í˜•íƒœ ë³€í™˜
```python
# object íƒ€ì…ì˜ dateë¥¼ datetime ë¡œ ë³€í™˜í•œë‹¤.
df['date'] = pd.to_datetime(df['date'])

print(f"start date: {df['date'].min()}")
print(f"end date: {df['date'].max()}")
```
```
start date: 2017-01-01 00:00:00
end date: 2021-12-31 00:00:00
```

'train.csv'ëŠ” 2017-01-01 ~ 2021-12-31 ì˜ íŒë§¤ ë°ì´í„°(5ë…„ì¹˜)ë¥¼ í¬í•¨í•œë‹¤.

## (3) ë‚ ì§œë³„ íŒë§¤ì¶”ì´
### 3-1. ì¼ë³„ ì´ íŒë§¤ëŸ‰
```python
daily_sales = df.groupby(by='date')['num_sold'].agg('sum')
daily_sales.plot(title='ì¼ë³„ ì´ íŒë§¤ëŸ‰(2017-2021)', ylabel='sum of sales', figsize=(12, 4));
```

<div style="text-align : center;">
<img src="/assets/images/project/s3e19/s3e19_2.png" width="90%">
</div>

<br>

ê·¸ë˜í”„ë¥¼ ë³´ë©´, xê°’ì´ 2018, 2019, 2020, 2021 ë¶€ê·¼ì—ì„œ íŒë§¤ëŸ‰ì´ ê¸‰ê²©íˆ ì¦ê°€í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤(ê³„ì ˆì„±ì´ ìˆëŠ” ê²ƒìœ¼ë¡œ íŒë‹¨ë¨). 2020ë…„ 1ë¶„ê¸°ì¯¤ì—ì„œ íŒë§¤ëŸ‰ì´ ê¸‰ê²©íˆ ê°ì†Œí•˜ëŠ”ë° ì´ëŠ” ì™¸ë¶€ìš”ì¸ìœ¼ë¡œ ì¸í•œ í˜„ìƒìœ¼ë¡œ ìƒê°ëœë‹¤(2020ë…„ì—ëŠ” ì½”ë¡œë‚˜ ë“± ì‚¬íšŒì  ì´ìŠˆê°€ íŒë§¤ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ì¤Œ). ì†Œë¹„ì˜ í–‰íƒœê°€ ì´ì»¤ë¨¸ìŠ¤ ì‹œì¥ìœ¼ë¡œ í™•ì¥ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.

### 3-2. ì›”ë³„ ì´ íŒë§¤ëŸ‰
```python
monthly_sales = df.resample(rule='M', on='date').sum()['num_sold']
monthly_sales.plot(title='ì›”ë³„ ì´ íŒë§¤ëŸ‰(2017-2021)', ylabel='sum of sales', figsize=(12, 4));
```

<div style="text-align : center;">
<img src="/assets/images/project/s3e19/s3e19_3.png" width="90%">
</div>

<br>

resample í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë‚ ì§œ ë°ì´í„°ë¥¼ íŠ¹ì • ê·œì¹™(íŠ¹ì • ì£¼ê¸°)ì„ ê¸°ì¤€ìœ¼ë¡œ êµ¬ê°„ë³„ ì§‘ê³„ê°€ ê°€ëŠ¥í•˜ë‹¤. ruleì— 'M'ì„ ì „ë‹¬í•˜ë©´ ë‚ ì§œê°€ í•´ë‹¹ ì›”ì˜ ë§ˆì§€ë§‰ ë‚ ì§œë¡œ ë³€í™˜ë˜ê³  ì›”ë³„ ë§ˆì§€ë§‰ ì¼ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ íŒë§¤ëŸ‰ì„ ì§‘ê³„í•˜ì˜€ë‹¤. ì›”ë³„ ì´ íŒë§¤ëŸ‰ ê·¸ë˜í”„ë¥¼ ë³´ë©´ íŒë§¤ë˜ëŠ” ì œí’ˆì˜ ìˆ˜ê°€ ì „ë°˜ì ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.

### 3-3. ì—°ë„, ì›”ë³„ íŒë§¤ëŸ‰
```python
monthly_year_sales = monthly_sales.reset_index()
monthly_year_sales['year'] = monthly_year_sales['date'].dt.year
monthly_year_sales['month'] = monthly_year_sales['date'].dt.month

figure(figsize=(12, 6))
sns.lineplot(data=monthly_year_sales, x='month', y='num_sold', hue='year').set(title='ì—°ë„, ì›”ë³„ íŒë§¤ëŸ‰', xlabel='Month', ylabel='Sum of sales');
```

<div style="text-align : center;">
<img src="/assets/images/project/s3e19/s3e19_4.png" width="90%">
</div>

<br>

ê° ì—°ë„ë³„ë¡œ ì›”ë³„ íŒë§¤ëŸ‰ì„ ê·¸ë˜í”„ë¡œ ê·¸ë ¤ë³´ì•˜ì„ ë•Œ, ì´ íŒë§¤ëŸ‰ì´ ë¹„ìŠ·í•œ ì¶”ì„¸ë¥¼ ê°€ì§€ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. í•œ í•´ì—ì„œ 1, 11, 12ì›”ì— ê°€ì¥ ë§ì€ ìƒí’ˆì´ íŒë§¤ëœë‹¤.

## (4) ë‚˜ë¼ë³„ íŒë§¤ì¶”ì´

## (5) ë§¤ì¥ë³„ íŒë§¤ì¶”ì´

## (6) ìƒí’ˆë³„ íŒë§¤ì¶”ì´